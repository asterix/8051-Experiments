;ASTER 06/03/2009 1245
;TO BE ASSEMBLED IN KEIL MICROVISION V3.60
;ARTIFICIAL INTELLIGENCE
;MICROCOMPUTER B   SERVO


;-----------------------------------------------------------------------------------------------------------
;SET THE ASSEMBLER FOR AT89S52
$NOMOD51
$INCLUDE (AT89X52.h)

;-----------------------------------------------------------------------------------------------------------

ORG 0000H

RESET:		SJMP 0030H 

ORG 0030H

START:		NOP
			MOV SP,#10H			  ;RELOCATE STACK OVER 10H
			MOV TMOD,#10H
			CLR TF1
			CLR P1.0
			LCALL DELAYH
								
			MOV R6,#05H
AGAIN:		MOV R7,#02H
N45MS:		CLR P1.0
			CLR TR1
			CLR TF1
			MOV TH1,#5DH
			MOV TL1,#0FDH
			SETB TR1
WAITH:		JNB TF1,WAITH
			CLR TF1
			DJNZ R7,N45MS
			CLR TR1
			MOV TH1,#0FDH
			MOV TL1,#0D7H
			SETB P1.0
			SETB TR1
WAITL:		JNB TF1,WAITL	
			DJNZ R6,AGAIN
			
			LCALL DELAYH
			LCALL DELAYH
			LCALL DELAYH
			
						
			MOV R6,#08H
AGAINC:		CLR TR1
			MOV TH1,#0E2H
			MOV TL1,#0D7H
			SETB P1.0
			SETB TR1
WAITLC:		JNB TF1,WAITLC
			MOV R7,#02H
N45MSC:		CLR P1.0
			CLR TR1
			CLR TF1
			MOV TH1,#5DH
			MOV TL1,#0FDH
			SETB TR1
WAITHC:		JNB TF1,WAITHC
			CLR TF1
			DJNZ R7,N45MSC
			DJNZ R6,AGAINC

HERE:		SJMP HERE


DELAYL:		MOV R7,#72
			MOV R6,#0FFH
			DJNZ R6,$
			DJNZ R7,$-2
			RET

DELAYH:		MOV R7,#0FH
			MOV R6,#0FFH
			MOV R5,#0FFH
			DJNZ R5,$
			DJNZ R6,$-2
			DJNZ R7,$-4
			RET
			
			 
END