A51 MACRO ASSEMBLER  ADINT                                                                03/02/2009 17:56:18 PAGE     1


MACRO ASSEMBLER A51 V8.01
OBJECT MODULE PLACED IN ADINT.OBJ
ASSEMBLER INVOKED BY: E:\Program Files\Keil\C51\BIN\A51.EXE ADINT.ASM NOMOD51 SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

                       1     $nomod51 
                       2     ;$include (AT89X52.h)
                +1     3     
                +1     4     
                +1     5     
                +1     6     
                +1     7     
                +1     8     
                +1     9     
                +1    10     
                +1    11     
                +1    12     
                +1    13     
                +1    14     
                +1    15     
                +1    16     
  0080          +1    17     sfr P0      = 0x80;
  0081          +1    18     sfr SP      = 0x81;
  0082          +1    19     sfr DPL     = 0x82;
  0083          +1    20     sfr DPH     = 0x83;
  0087          +1    21     sfr PCON    = 0x87;
  0088          +1    22     sfr TCON    = 0x88;
  0089          +1    23     sfr TMOD    = 0x89;
  008A          +1    24     sfr TL0     = 0x8A;
  008B          +1    25     sfr TL1     = 0x8B;
  008C          +1    26     sfr TH0     = 0x8C;
  008D          +1    27     sfr TH1     = 0x8D;
  0090          +1    28     sfr P1      = 0x90;
  0098          +1    29     sfr SCON    = 0x98;
  0099          +1    30     sfr SBUF    = 0x99;
  00A0          +1    31     sfr P2      = 0xA0;
  00A8          +1    32     sfr IE      = 0xA8;
  00B0          +1    33     sfr P3      = 0xB0;
  00B8          +1    34     sfr IP      = 0xB8;
  00C8          +1    35     sfr T2CON   = 0xC8;
  00C9          +1    36     sfr T2MOD   = 0xC9;
  00CA          +1    37     sfr RCAP2L  = 0xCA;
  00CB          +1    38     sfr RCAP2H  = 0xCB;
  00CC          +1    39     sfr TL2     = 0xCC;
  00CD          +1    40     sfr TH2     = 0xCD;
  00D0          +1    41     sfr PSW     = 0xD0;
  00E0          +1    42     sfr ACC     = 0xE0;
  00F0          +1    43     sfr B       = 0xF0;
                +1    44     
                +1    45     
                +1    46     
                +1    47     
  0080          +1    48     sbit P0_0 = 0x80;
  0081          +1    49     sbit P0_1 = 0x81;
  0082          +1    50     sbit P0_2 = 0x82;
  0083          +1    51     sbit P0_3 = 0x83;
  0084          +1    52     sbit P0_4 = 0x84;
  0085          +1    53     sbit P0_5 = 0x85;
  0086          +1    54     sbit P0_6 = 0x86;
  0087          +1    55     sbit P0_7 = 0x87;
                +1    56     
                +1    57     
                +1    58     
A51 MACRO ASSEMBLER  ADINT                                                                03/02/2009 17:56:18 PAGE     2

                +1    59     
                +1    60     
                +1    61     
                +1    62     
                +1    63     
                +1    64     
                +1    65     
                +1    66     
                +1    67     
                +1    68     
                +1    69     
                +1    70     
                +1    71     
  0088          +1    72     sbit IT0  = 0x88;
  0089          +1    73     sbit IE0  = 0x89;
  008A          +1    74     sbit IT1  = 0x8A;
  008B          +1    75     sbit IE1  = 0x8B;
  008C          +1    76     sbit TR0  = 0x8C;
  008D          +1    77     sbit TF0  = 0x8D;
  008E          +1    78     sbit TR1  = 0x8E;
  008F          +1    79     sbit TF1  = 0x8F;
                +1    80     
                +1    81     
                +1    82     
                +1    83     
                +1    84     
                +1    85     
                +1    86     
                +1    87     
                +1    88     
                +1    89     
                +1    90     
                +1    91     
                +1    92     
                +1    93     
                +1    94     
                +1    95     
                +1    96     
                +1    97     
                +1    98     
  0090          +1    99     sbit P1_0 = 0x90;
  0091          +1   100     sbit P1_1 = 0x91;
  0092          +1   101     sbit P1_2 = 0x92;
  0093          +1   102     sbit P1_3 = 0x93;
  0094          +1   103     sbit P1_4 = 0x94;
  0095          +1   104     sbit P1_5 = 0x95;
  0096          +1   105     sbit P1_6 = 0x96;
  0097          +1   106     sbit P1_7 = 0x97;
                +1   107     
  0090          +1   108     sbit T2   = 0x90;       /* External input to Timer/Counter 2, clock out */
  0091          +1   109     sbit T2EX = 0x91;       /* Timer/Counter 2 capture/reload trigger & dir ctl */
                +1   110     
                +1   111     
                +1   112     
                +1   113     
  0098          +1   114     sbit RI   = 0x98;
  0099          +1   115     sbit TI   = 0x99;
  009A          +1   116     sbit RB8  = 0x9A;
  009B          +1   117     sbit TB8  = 0x9B;
  009C          +1   118     sbit REN  = 0x9C;
  009D          +1   119     sbit SM2  = 0x9D;
  009E          +1   120     sbit SM1  = 0x9E;
  009F          +1   121     sbit SM0  = 0x9F;
                +1   122     
                +1   123     
                +1   124     
A51 MACRO ASSEMBLER  ADINT                                                                03/02/2009 17:56:18 PAGE     3

                +1   125     
  00A0          +1   126     sbit P2_0 = 0xA0;
  00A1          +1   127     sbit P2_1 = 0xA1;
  00A2          +1   128     sbit P2_2 = 0xA2;
  00A3          +1   129     sbit P2_3 = 0xA3;
  00A4          +1   130     sbit P2_4 = 0xA4;
  00A5          +1   131     sbit P2_5 = 0xA5;
  00A6          +1   132     sbit P2_6 = 0xA6;
  00A7          +1   133     sbit P2_7 = 0xA7;
                +1   134     
                +1   135     
                +1   136     
                +1   137     
  00A8          +1   138     sbit EX0  = 0xA8;       /* 1=Enable External interrupt 0 */
  00A9          +1   139     sbit ET0  = 0xA9;       /* 1=Enable Timer 0 interrupt */
  00AA          +1   140     sbit EX1  = 0xAA;       /* 1=Enable External interrupt 1 */
  00AB          +1   141     sbit ET1  = 0xAB;       /* 1=Enable Timer 1 interrupt */
  00AC          +1   142     sbit ES   = 0xAC;       /* 1=Enable Serial port interrupt */
  00AD          +1   143     sbit ET2  = 0xAD;       /* 1=Enable Timer 2 interrupt */
                +1   144     
  00AF          +1   145     sbit EA   = 0xAF;       /* 0=Disable all interrupts */
                +1   146     
                +1   147     
                +1   148     
                +1   149     
  00B0          +1   150     sbit P3_0 = 0xB0;
  00B1          +1   151     sbit P3_1 = 0xB1;
  00B2          +1   152     sbit P3_2 = 0xB2;
  00B3          +1   153     sbit P3_3 = 0xB3;
  00B4          +1   154     sbit P3_4 = 0xB4;
  00B5          +1   155     sbit P3_5 = 0xB5;
  00B6          +1   156     sbit P3_6 = 0xB6;
  00B7          +1   157     sbit P3_7 = 0xB7;
                +1   158     
  00B0          +1   159     sbit RXD  = 0xB0;       /* Serial data input */
  00B1          +1   160     sbit TXD  = 0xB1;       /* Serial data output */
  00B2          +1   161     sbit INT0 = 0xB2;       /* External interrupt 0 */
  00B3          +1   162     sbit INT1 = 0xB3;       /* External interrupt 1 */
  00B4          +1   163     sbit T0   = 0xB4;       /* Timer 0 external input */
  00B5          +1   164     sbit T1   = 0xB5;       /* Timer 1 external input */
  00B6          +1   165     sbit WR   = 0xB6;       /* External data memory write strobe */
  00B7          +1   166     sbit RD   = 0xB7;       /* External data memory read strobe */
                +1   167     
                +1   168     
                +1   169     
                +1   170     
  00B8          +1   171     sbit PX0  = 0xB8;
  00B9          +1   172     sbit PT0  = 0xB9;
  00BA          +1   173     sbit PX1  = 0xBA;
  00BB          +1   174     sbit PT1  = 0xBB;
  00BC          +1   175     sbit PS   = 0xBC;
  00BD          +1   176     sbit PT2  = 0xBD;
                +1   177     
                +1   178     
                +1   179     
                +1   180     
  00C8          +1   181     sbit CP_RL2= 0xC8;      /* 0=Reload, 1=Capture select */
  00C9          +1   182     sbit C_T2 = 0xC9;       /* 0=Timer, 1=Counter */
  00CA          +1   183     sbit TR2  = 0xCA;       /* 0=Stop timer, 1=Start timer */
  00CB          +1   184     sbit EXEN2= 0xCB;       /* Timer 2 external enable */
  00CC          +1   185     sbit TCLK = 0xCC;       /* 0=Serial clock uses Timer 1 overflow, 1=Timer 2 */
  00CD          +1   186     sbit RCLK = 0xCD;       /* 0=Serial clock uses Timer 1 overflow, 1=Timer 2 */
  00CE          +1   187     sbit EXF2 = 0xCE;       /* Timer 2 external flag */
  00CF          +1   188     sbit TF2  = 0xCF;       /* Timer 2 overflow flag */
                +1   189     
                +1   190     
A51 MACRO ASSEMBLER  ADINT                                                                03/02/2009 17:56:18 PAGE     4

                +1   191     
                +1   192     
                +1   193     
                +1   194     
                +1   195     
                +1   196     
                +1   197     
                +1   198     
  00D0          +1   199     sbit P    = 0xD0;
  00D1          +1   200     sbit F1   = 0xD1;
  00D2          +1   201     sbit OV   = 0xD2;
  00D3          +1   202     sbit RS0  = 0xD3;
  00D4          +1   203     sbit RS1  = 0xD4;
  00D5          +1   204     sbit F0   = 0xD5;
  00D6          +1   205     sbit AC   = 0xD6;
  00D7          +1   206     sbit CY   = 0xD7;
                +1   207     
                +1   208     
                +1   209     
                +1   210     
                +1   211     
                +1   212     
                +1   213     
                +1   214     
                +1   215     
                +1   216     
                +1   217     
                +1   218     
                +1   219     
                +1   220     
                +1   221     
                +1   222     
                +1   223     
                     224     
                     225     
0000                 226     ORG 0000H
0000 802E            227     SJMP 0030H
                     228     
                     229     
                     230     
                     231     
0030                 232     ORG 0030H
                     233     
                     234     
                     235     
                     236     
0030 758801          237     START:  MOV TCON,#01H
0033 75A891          238                     MOV IE,#91H                                     ;INTERRUPTS ENABLE : INT0, 
                             SERIAL
0036 75B810          239                     MOV IP,#10H     
                     240     
                     241     
0039 759000          242                     MOV P1,#00H
003C 75B00A          243                     MOV P3,#0AH
003F 75A000          244                     MOV P2,#00H
                     245     
0042 7408            246                     MOV A,#08H      ; SINGLE ENDED CHANNEL 1  :: 0000 1000
                     247             
0044 114D            248                     ACALL WRITE     ; START CONVERSION
                     249             
                     250             
                     251     
0046 8560A0          252     HERE:   MOV P2,60H
0049 80FB            253                     SJMP HERE 
                     254             
                     255             ;       ACALL READY     ; CHECK IF CONVERSION IS DONE :: INTR BAR IS LOW
A51 MACRO ASSEMBLER  ADINT                                                                03/02/2009 17:56:18 PAGE     5

                     256                     
                     257             
                     258     
                     259             ;       ACALL READ      ; READ DB0 TO DB7 AND PLACE IN R0
                     260                     
                     261             
                     262     
                     263             ;       MOV P2,R0       ; OUTPUT DIGITAL CONVERSION
                     264                     
                     265             ;       ACALL DELAY
                     266     
004B 80E3            267     STOP:           SJMP START
                     268     
                     269     
                     270     
                     271     
004D F590            272     WRITE:  MOV P1,A        
004F D2B7            273                     SETB RD
0051 D2B6            274                     SETB WR ; SET WR BAR
0053 00              275                     NOP
0054 C2B6            276                     CLR WR  ; CLEAR WR BAR
0056 00              277                     NOP
0057 00              278                     NOP
0058 00              279                     NOP
0059 D2B6            280                     SETB WR ; RISING EDGE ON WR BAR
005B 22              281                     RET
                     282     
                     283     
                     284     
005C D2B6            285     READY:          SETB WR
005E D2B7            286                     SETB RD
                     287     
                     288                     ;SETB P3.7      ; WATCH BITS
                     289                     ;SETB P3.6
                     290     
0060 20B2FD          291     WAIT:           JB P3.2,WAIT    ; WAIT TILL INTR BAR IS LOW
                     292                     ;CLR P3.7
                     293             ;CLR P3.6
0063 00              294                     NOP
0064 22              295                     RET
                     296     
                     297     
0065 D2B6            298     READ:           SETB WR
0067 C2B7            299                     CLR RD  ; RD BAR LOW
0069 00              300                     NOP
006A 00              301                     NOP
006B 7590FF          302                     MOV P1,#0FFH    ;CONFIGURE PORT FOR INPUT::: DONT FORGET THIS
006E E590            303                     MOV A,P1
0070 00              304                     NOP
0071 00              305                     NOP
0072 22              306                     RET                             
                     307                     
                     308     
                     309     
0073 7F08            310     DELAY:          MOV R7,#08H
0075 7EFF            311                     MOV R6,#0FFH
0077 7DFF            312                     MOV R5,#0FFH
0079 DDFE            313                     DJNZ R5,$
007B DEFC            314                     DJNZ R6,$-2
007D DFFA            315                     DJNZ R7,$-4     
007F 22              316                     RET
                     317     
                     318     
0003                 319     ORG 0003H
0003 021200          320     LJMP 1200H
1200                 321     ORG 1200H
A51 MACRO ASSEMBLER  ADINT                                                                03/02/2009 17:56:18 PAGE     6

1200 00              322     INTRR:  NOP
1201 00              323                     NOP
1202 00              324                     NOP
1203 00              325                     NOP
1204 120065          326                     LCALL READ
1207 F560            327                     MOV 60H,A
1209 7408            328                     MOV A,#08H
120B 12004D          329                     LCALL WRITE
120E 32              330                     RETI
                     331     
                     332     
                     333     END
                             
A51 MACRO ASSEMBLER  ADINT                                                                03/02/2009 17:56:18 PAGE     7

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

AC . . . . . . . .  B ADDR   00D0H.6 A   
ACC. . . . . . . .  D ADDR   00E0H   A   
B. . . . . . . . .  D ADDR   00F0H   A   
CP_RL2 . . . . . .  B ADDR   00C8H.0 A   
CY . . . . . . . .  B ADDR   00D0H.7 A   
C_T2 . . . . . . .  B ADDR   00C8H.1 A   
DELAY. . . . . . .  C ADDR   0073H   A   
DPH. . . . . . . .  D ADDR   0083H   A   
DPL. . . . . . . .  D ADDR   0082H   A   
EA . . . . . . . .  B ADDR   00A8H.7 A   
ES . . . . . . . .  B ADDR   00A8H.4 A   
ET0. . . . . . . .  B ADDR   00A8H.1 A   
ET1. . . . . . . .  B ADDR   00A8H.3 A   
ET2. . . . . . . .  B ADDR   00A8H.5 A   
EX0. . . . . . . .  B ADDR   00A8H.0 A   
EX1. . . . . . . .  B ADDR   00A8H.2 A   
EXEN2. . . . . . .  B ADDR   00C8H.3 A   
EXF2 . . . . . . .  B ADDR   00C8H.6 A   
F0 . . . . . . . .  B ADDR   00D0H.5 A   
F1 . . . . . . . .  B ADDR   00D0H.1 A   
HERE . . . . . . .  C ADDR   0046H   A   
IE . . . . . . . .  D ADDR   00A8H   A   
IE0. . . . . . . .  B ADDR   0088H.1 A   
IE1. . . . . . . .  B ADDR   0088H.3 A   
INT0 . . . . . . .  B ADDR   00B0H.2 A   
INT1 . . . . . . .  B ADDR   00B0H.3 A   
INTRR. . . . . . .  C ADDR   1200H   A   
IP . . . . . . . .  D ADDR   00B8H   A   
IT0. . . . . . . .  B ADDR   0088H.0 A   
IT1. . . . . . . .  B ADDR   0088H.2 A   
OV . . . . . . . .  B ADDR   00D0H.2 A   
P. . . . . . . . .  B ADDR   00D0H.0 A   
P0 . . . . . . . .  D ADDR   0080H   A   
P0_0 . . . . . . .  B ADDR   0080H.0 A   
P0_1 . . . . . . .  B ADDR   0080H.1 A   
P0_2 . . . . . . .  B ADDR   0080H.2 A   
P0_3 . . . . . . .  B ADDR   0080H.3 A   
P0_4 . . . . . . .  B ADDR   0080H.4 A   
P0_5 . . . . . . .  B ADDR   0080H.5 A   
P0_6 . . . . . . .  B ADDR   0080H.6 A   
P0_7 . . . . . . .  B ADDR   0080H.7 A   
P1 . . . . . . . .  D ADDR   0090H   A   
P1_0 . . . . . . .  B ADDR   0090H.0 A   
P1_1 . . . . . . .  B ADDR   0090H.1 A   
P1_2 . . . . . . .  B ADDR   0090H.2 A   
P1_3 . . . . . . .  B ADDR   0090H.3 A   
P1_4 . . . . . . .  B ADDR   0090H.4 A   
P1_5 . . . . . . .  B ADDR   0090H.5 A   
P1_6 . . . . . . .  B ADDR   0090H.6 A   
P1_7 . . . . . . .  B ADDR   0090H.7 A   
P2 . . . . . . . .  D ADDR   00A0H   A   
P2_0 . . . . . . .  B ADDR   00A0H.0 A   
P2_1 . . . . . . .  B ADDR   00A0H.1 A   
P2_2 . . . . . . .  B ADDR   00A0H.2 A   
P2_3 . . . . . . .  B ADDR   00A0H.3 A   
P2_4 . . . . . . .  B ADDR   00A0H.4 A   
P2_5 . . . . . . .  B ADDR   00A0H.5 A   
P2_6 . . . . . . .  B ADDR   00A0H.6 A   
P2_7 . . . . . . .  B ADDR   00A0H.7 A   
P3 . . . . . . . .  D ADDR   00B0H   A   
A51 MACRO ASSEMBLER  ADINT                                                                03/02/2009 17:56:18 PAGE     8

P3_0 . . . . . . .  B ADDR   00B0H.0 A   
P3_1 . . . . . . .  B ADDR   00B0H.1 A   
P3_2 . . . . . . .  B ADDR   00B0H.2 A   
P3_3 . . . . . . .  B ADDR   00B0H.3 A   
P3_4 . . . . . . .  B ADDR   00B0H.4 A   
P3_5 . . . . . . .  B ADDR   00B0H.5 A   
P3_6 . . . . . . .  B ADDR   00B0H.6 A   
P3_7 . . . . . . .  B ADDR   00B0H.7 A   
PCON . . . . . . .  D ADDR   0087H   A   
PS . . . . . . . .  B ADDR   00B8H.4 A   
PSW. . . . . . . .  D ADDR   00D0H   A   
PT0. . . . . . . .  B ADDR   00B8H.1 A   
PT1. . . . . . . .  B ADDR   00B8H.3 A   
PT2. . . . . . . .  B ADDR   00B8H.5 A   
PX0. . . . . . . .  B ADDR   00B8H.0 A   
PX1. . . . . . . .  B ADDR   00B8H.2 A   
RB8. . . . . . . .  B ADDR   0098H.2 A   
RCAP2H . . . . . .  D ADDR   00CBH   A   
RCAP2L . . . . . .  D ADDR   00CAH   A   
RCLK . . . . . . .  B ADDR   00C8H.5 A   
RD . . . . . . . .  B ADDR   00B0H.7 A   
READ . . . . . . .  C ADDR   0065H   A   
READY. . . . . . .  C ADDR   005CH   A   
REN. . . . . . . .  B ADDR   0098H.4 A   
RI . . . . . . . .  B ADDR   0098H.0 A   
RS0. . . . . . . .  B ADDR   00D0H.3 A   
RS1. . . . . . . .  B ADDR   00D0H.4 A   
RXD. . . . . . . .  B ADDR   00B0H.0 A   
SBUF . . . . . . .  D ADDR   0099H   A   
SCON . . . . . . .  D ADDR   0098H   A   
SM0. . . . . . . .  B ADDR   0098H.7 A   
SM1. . . . . . . .  B ADDR   0098H.6 A   
SM2. . . . . . . .  B ADDR   0098H.5 A   
SP . . . . . . . .  D ADDR   0081H   A   
START. . . . . . .  C ADDR   0030H   A   
STOP . . . . . . .  C ADDR   004BH   A   
T0 . . . . . . . .  B ADDR   00B0H.4 A   
T1 . . . . . . . .  B ADDR   00B0H.5 A   
T2 . . . . . . . .  B ADDR   0090H.0 A   
T2CON. . . . . . .  D ADDR   00C8H   A   
T2EX . . . . . . .  B ADDR   0090H.1 A   
T2MOD. . . . . . .  D ADDR   00C9H   A   
TB8. . . . . . . .  B ADDR   0098H.3 A   
TCLK . . . . . . .  B ADDR   00C8H.4 A   
TCON . . . . . . .  D ADDR   0088H   A   
TF0. . . . . . . .  B ADDR   0088H.5 A   
TF1. . . . . . . .  B ADDR   0088H.7 A   
TF2. . . . . . . .  B ADDR   00C8H.7 A   
TH0. . . . . . . .  D ADDR   008CH   A   
TH1. . . . . . . .  D ADDR   008DH   A   
TH2. . . . . . . .  D ADDR   00CDH   A   
TI . . . . . . . .  B ADDR   0098H.1 A   
TL0. . . . . . . .  D ADDR   008AH   A   
TL1. . . . . . . .  D ADDR   008BH   A   
TL2. . . . . . . .  D ADDR   00CCH   A   
TMOD . . . . . . .  D ADDR   0089H   A   
TR0. . . . . . . .  B ADDR   0088H.4 A   
TR1. . . . . . . .  B ADDR   0088H.6 A   
TR2. . . . . . . .  B ADDR   00C8H.2 A   
TXD. . . . . . . .  B ADDR   00B0H.1 A   
WAIT . . . . . . .  C ADDR   0060H   A   
WR . . . . . . . .  B ADDR   00B0H.6 A   
WRITE. . . . . . .  C ADDR   004DH   A   


REGISTER BANK(S) USED: 0 
A51 MACRO ASSEMBLER  ADINT                                                                03/02/2009 17:56:18 PAGE     9



ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
